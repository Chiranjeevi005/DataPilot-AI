INFO:jobs.process_job:Starting processing for job test_phase6_job (file: file://C:\Users\Chiranjeevi PK\Desktop\datapilot-ai\tmp_uploads\test_phase6_job\data.csv)
C:\Users\Chiranjeevi PK\Desktop\datapilot-ai\src\jobs\process_job.py:183: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  current['updatedAt'] = datetime.utcnow().isoformat() + "Z"
INFO:lib.storage:Ensuring local path for file://C:\Users\Chiranjeevi PK\Desktop\datapilot-ai\tmp_uploads\test_phase6_job\data.csv
INFO:jobs.process_job:Detected file type: csv
ERROR:jobs.process_job:Error during parsing/extraction: [WinError 3] The system cannot find the path specified: ''
C:\Users\Chiranjeevi PK\Desktop\datapilot-ai\src\jobs\process_job.py:218: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "processedAt": datetime.utcnow().isoformat() + "Z"
INFO:lib.storage:Saved file locally for job test_phase6_job at C:\Users\Chiranjeevi PK\Desktop\datapilot-ai\tmp_uploads\test_phase6_job\result.json
C:\Users\Chiranjeevi PK\Desktop\datapilot-ai\src\jobs\process_job.py:190: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  current['updatedAt'] = datetime.utcnow().isoformat() + "Z"
FINFO:jobs.process_job:Starting processing for job test_phase6_job_fail (file: file://C:\Users\Chiranjeevi PK\Desktop\datapilot-ai\tmp_uploads\test_phase6_job\data.csv)
INFO:lib.storage:Ensuring local path for file://C:\Users\Chiranjeevi PK\Desktop\datapilot-ai\tmp_uploads\test_phase6_job\data.csv
INFO:jobs.process_job:Detected file type: csv
ERROR:jobs.process_job:Error during parsing/extraction: [WinError 3] The system cannot find the path specified: ''
INFO:lib.storage:Saved file locally for job test_phase6_job_fail at C:\Users\Chiranjeevi PK\Desktop\datapilot-ai\tmp_uploads\test_phase6_job_fail\result.json
F
======================================================================
FAIL: test_happy_path_mock_llm (__main__.TestPhase6.test_happy_path_mock_llm)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\Users\Chiranjeevi PK\Desktop\datapilot-ai\scripts\test_phase6.py", line 64, in test_happy_path_mock_llm
    self.assertIn("analystInsights", result)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: 'analystInsights' not found in {'jobId': 'test_phase6_job', 'fileInfo': {'name': 'data.csv', 'type': 'csv', 'rows': 0, 'cols': 0}, 'schema': [], 'kpis': {'rowCount': 0, 'colCount': 0, 'missingCount': 0}, 'cleanedPreview': [], 'chartSpecs': [], 'qualityScore': 0, 'issues': ["Parsing error: [WinError 3] The system cannot find the path specified: ''"], 'text_extract': 'No content extracted.', 'processedAt': '2025-12-06T09:07:59.963257Z'}

======================================================================
FAIL: test_llm_failure_handling (__main__.TestPhase6.test_llm_failure_handling)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\Users\Chiranjeevi PK\AppData\Local\Programs\Python\Python313\Lib\unittest\mock.py", line 1426, in patched
    return func(*newargs, **newkeywargs)
  File "C:\Users\Chiranjeevi PK\Desktop\datapilot-ai\scripts\test_phase6.py", line 97, in test_llm_failure_handling
    self.assertIn("analystInsights", result)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: 'analystInsights' not found in {'jobId': 'test_phase6_job_fail', 'fileInfo': {'name': 'data.csv', 'type': 'csv', 'rows': 0, 'cols': 0}, 'schema': [], 'kpis': {'rowCount': 0, 'colCount': 0, 'missingCount': 0}, 'cleanedPreview': [], 'chartSpecs': [], 'qualityScore': 0, 'issues': ["Parsing error: [WinError 3] The system cannot find the path specified: ''"], 'text_extract': 'No content extracted.', 'processedAt': '2025-12-06T09:07:59.989216Z'}

----------------------------------------------------------------------
Ran 2 tests in 0.043s

FAILED (failures=2)

--- Testing Happy Path (Mock LLM) ---
Result Keys: ['jobId', 'fileInfo', 'schema', 'kpis', 'cleanedPreview', 'chartSpecs', 'qualityScore', 'issues', 'text_extract', 'processedAt']
Job Issues: ["Parsing error: [WinError 3] The system cannot find the path specified: ''"]

--- Testing Failure Path ---
